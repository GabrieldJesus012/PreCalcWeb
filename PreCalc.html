<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora Previdenci√°ria</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50, #3498db);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .form-section {
            padding: 30px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
        }

        .form-group {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            border-left: 5px solid #3498db;
            transition: transform 0.3s ease;
        }

        .form-group:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .form-group h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.3em;
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 10px;
        }

        .input-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #34495e;
        }

        input, select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .btn {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 50px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(52, 152, 219, 0.3);
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(52, 152, 219, 0.4);
        }

        .btn-container {
            text-align: center;
            margin: 30px 0;
        }

        .results {
            margin-top: 40px;
            padding: 30px;
            background: #f8f9fa;
            border-radius: 15px;
        }

        .table-container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
        }

        th {
            background: linear-gradient(135deg, #34495e, #2c3e50);
            color: white;
            font-weight: 600;
        }

        tr:hover {
            background: #f1f3f4;
        }

        .highlight {
            background: linear-gradient(135deg, #e8f5e8, #d4edda);
            font-weight: bold;
        }

        .section-title {
            color: #2c3e50;
            font-size: 1.5em;
            margin: 20px 0 10px 0;
            padding: 10px;
            background: linear-gradient(135deg, #ecf0f1, #bdc3c7);
            border-radius: 8px;
        }

        .hidden {
            display: none;
        }

        .loading {
            text-align: center;
            padding: 20px;
            font-style: italic;
            color: #7f8c8d;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üíºPreCalc</h1>
            <p>C√°lculos de Precat√≥rios</p>
        </div>

        <form id="calculatorForm" class="form-section">
            <div class="form-group">
                <h3>üìÖ Dados B√°sicos</h3>
                <div class="input-group">
                    <label>Processo:</label>
                    <input type="text" id="numprocesso" placeholder="N√∫mero do processo">
                </div>
                <div class="input-group">
                    <label>Benefici√°rio:</label>
                    <input type="text" id="beneficiario" placeholder="Nome do benefici√°rio">
                </div>
                <div class="input-group">
                    <label>Devedor:</label>
                    <input type="text" id="credor" placeholder="Nome do Devedor">
                </div>
                <div class="input-group">
                    <label>Ano do Or√ßamento:</label>
                    <input type="number" id="anoOrcamento" placeholder="Ano do Or√ßamento">
                </div>
                <div class="input-group">
                    <label>M√™s Base:</label>
                    <select id="mesBase">
                        <option value="janeiro">Janeiro</option>
                        <option value="fevereiro">Fevereiro</option>
                        <option value="mar√ßo">Mar√ßo</option>
                        <option value="abril">Abril</option>
                        <option value="maio">Maio</option>
                        <option value="junho">Junho</option>
                        <option value="julho">Julho</option>
                        <option value="agosto">Agosto</option>
                        <option value="setembro">Setembro</option>
                        <option value="outubro">Outubro</option>
                        <option value="novembro">Novembro</option>
                        <option value="dezembro">Dezembro</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Ano Base:</label>
                    <input type="number" id="anoBase" placeholder="Ano Base">
                </div>
            </div>

            <div class="form-group">
                <h3>üí∞ Valores Financeiros</h3>
                <div class="input-group">
                    <label>Valor Principal (R$):</label>
                    <input type="number" id="valorPrincipal" step="0.01" placeholder="0.00">
                </div>
                <div class="input-group">
                    <label>Valor dos Juros (R$):</label>
                    <input type="number" id="valorJuros" step="0.01" placeholder="0.00">
                </div>
                <div class="input-group">
                    <label>Valor Selic (R$):</label>
                    <input type="number" id="valorSelic" step="0.01" placeholder="0.00">
                </div>
                <div class="input-group">
                    <label>RRA:</label>
                    <input type="number" id="rra" value="0" min="0">
                </div>
            </div>

            <div class="form-group">
                <h3>‚öñÔ∏è Configura√ß√µes Legais</h3>
                <div class="input-group">
                    <label>Natureza da A√ß√£o:</label>
                    <select id="natureza">
                        <option value="alimentar">Alimentar</option>
                        <option value="comum">Comum</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Tipo de C√°lculo:</label>
                    <select id="tipoCalculo">
                        <option value="ordem">Ordem</option>
                        <option value="preferencia">Prefer√™ncia</option>
                        <option value="acordo">Acordo</option>
                    </select>
                </div>
                <div class="input-group" id="tetoPreferencia" style="display: none;">
                    <label>Teto de Prefer√™ncia (R$):</label>
                    <input type="number" id="tetoPreferenciaPrincipal" step="0.01" placeholder="0.00">
                </div>
                <div class="input-group" id="percentualAcordo" style="display: none;">
                    <label>% do Des√°gio (ex: 0.2 para 20%):</label>
                    <input type="number" id="percentualAcordoValor" step="0.01" min="0" max="1" placeholder="0.00">
                </div>
            </div>

            <div class="form-group">
                <h3>üè¶ Impostos e Contribui√ß√µes</h3>
                <div class="input-group">
                    <label>Incid√™ncia de IR:</label>
                    <select id="incidenciaIR">
                        <option value="nao">N√£o</option>
                        <option value="sim">Sim</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Incid√™ncia de Previd√™ncia:</label>
                    <select id="incidenciaPrevidencia">
                        <option value="nao">N√£o</option>
                        <option value="sim">Sim</option>
                    </select>
                </div>
                <div class="input-group" id="tipoPrevidenciaDiv" style="display: none;">
                    <label>Tipo de Previd√™ncia:</label>
                    <select id="tipoPrevidencia">
                        <option value="inss">INSS</option>
                        <option value="fixa">Al√≠quota Fixa</option>
                    </select>
                </div>
                <div class="input-group" id="aliquotaFixaDiv" style="display: none;">
                    <label>Al√≠quota Fixa (ex: 0.14 para 14%):</label>
                    <input type="number" id="aliquotaFixa" step="0.01" min="0" max="1" placeholder="0.00">
                </div>
            </div>

            <div class="form-group">
                <h3>üë©‚Äçüíº Honor√°rios Contratuais</h3>
                <div class="input-group">
                    <label>Quantidade de Advogados:</label>
                    <input type="number" id="quantAdvogados" value="0" min="0" max="10">
                </div>
                <div id="advogadosContainer"></div>
            </div>
        </form>

        <div class="btn-container">
            <button type="button" class="btn" onclick="calcular()">üßÆ Calcular Valores</button>
        </div>

        <div id="results" class="results hidden">
            <div class="section-title">üìä Resultados dos C√°lculos</div>
            <div id="resultadosContent"></div>
        </div>
    </div>

    <script>
        // Configura√ß√µes e dados simulados
        const meses = {
            "janeiro": 1, "fevereiro": 2, "mar√ßo": 3, "abril": 4,
            "maio": 5, "junho": 6, "julho": 7, "agosto": 8,
            "setembro": 9, "outubro": 10, "novembro": 11, "dezembro": 12
        };

        // Event listeners
        document.getElementById('tipoCalculo').addEventListener('change', function() {
            const tipo = this.value;
            const natureza = document.getElementById('natureza').value;
            
            document.getElementById('tetoPreferencia').style.display = 
                (tipo === 'preferencia' && natureza === 'alimentar') ? 'block' : 'none';
            document.getElementById('percentualAcordo').style.display = 
                tipo === 'acordo' ? 'block' : 'none';
        });

        document.getElementById('natureza').addEventListener('change', function() {
            const natureza = this.value;
            const tipo = document.getElementById('tipoCalculo').value;
            
            document.getElementById('tetoPreferencia').style.display = 
                (tipo === 'preferencia' && natureza === 'alimentar') ? 'block' : 'none';
        });

        document.getElementById('incidenciaPrevidencia').addEventListener('change', function() {
            const incidencia = this.value;
            document.getElementById('tipoPrevidenciaDiv').style.display = 
                incidencia === 'sim' ? 'block' : 'none';
        });

        document.getElementById('tipoPrevidencia').addEventListener('change', function() {
            const tipo = this.value;
            document.getElementById('aliquotaFixaDiv').style.display = 
                tipo === 'fixa' ? 'block' : 'none';
        });

        document.getElementById('quantAdvogados').addEventListener('change', function() {
            const quant = parseInt(this.value);
            const container = document.getElementById('advogadosContainer');
            container.innerHTML = '';
            
            for (let i = 0; i < quant; i++) {
                const advDiv = document.createElement('div');
                advDiv.innerHTML = `
                    <h4>Advogado ${i + 1}:</h4>
                    <div class="input-group">
                        <label>Nome:</label>
                        <input type="text" id="advNome${i}" placeholder="Nome do advogado">
                    </div>
                    <div class="input-group">
                        <label>Tipo:</label>
                        <select id="advTipo${i}">
                            <option value="PF">Pessoa F√≠sica</option>
                            <option value="PJ">Pessoa Jur√≠dica</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label>Percentual (ex: 0.1 para 10%):</label>
                        <input type="number" id="advPercentual${i}" step="0.01" min="0" max="1" placeholder="0.00">
                    </div>
                    <hr style="margin: 15px 0; border: 1px solid #e9ecef;">
                `;
                container.appendChild(advDiv);
            }
        });

        function calcular() {
            // Coletar dados do formul√°rio
            const dados = coletarDados();
            
            // Simular c√°lculos (vers√£o simplificada dos c√°lculos do Python)
            const resultados = calcularValores(dados);
            
            // Exibir resultados
            exibirResultados(resultados, dados);
        }

        function coletarDados() {
            const dados = {
                anoOrcamento: parseInt(document.getElementById('anoOrcamento').value),
                beneficiario: document.getElementById('beneficiario').value,
                mesBase: document.getElementById('mesBase').value,
                anoBase: parseInt(document.getElementById('anoBase').value),
                valorPrincipal: parseFloat(document.getElementById('valorPrincipal').value) || 0,
                valorJuros: parseFloat(document.getElementById('valorJuros').value) || 0,
                rra: parseInt(document.getElementById('rra').value) || 0,
                natureza: document.getElementById('natureza').value,
                tipoCalculo: document.getElementById('tipoCalculo').value,
                incidenciaIR: document.getElementById('incidenciaIR').value === 'sim',
                incidenciaPrevidencia: document.getElementById('incidenciaPrevidencia').value === 'sim',
                tipoPrevidencia: document.getElementById('tipoPrevidencia').value,
                aliquotaFixa: parseFloat(document.getElementById('aliquotaFixa').value) || 0,
                quantAdvogados: parseInt(document.getElementById('quantAdvogados').value) || 0,
                advogados: []
            };

            // Dados espec√≠ficos por tipo de c√°lculo
            if (dados.tipoCalculo === 'preferencia') {
                dados.tetoPreferencia = parseFloat(document.getElementById('tetoPreferenciaPrincipal').value) || 0;
            }
            if (dados.tipoCalculo === 'acordo') {
                dados.percentualAcordo = parseFloat(document.getElementById('percentualAcordoValor').value) || 0;
            }

            // Coletar dados dos advogados
            for (let i = 0; i < dados.quantAdvogados; i++) {
                dados.advogados.push({
                    nome: document.getElementById(`advNome${i}`).value,
                    tipo: document.getElementById(`advTipo${i}`).value,
                    percentual: parseFloat(document.getElementById(`advPercentual${i}`).value) || 0
                });
            }

            return dados;
        }

        function calcularValores(dados) {
            // Simula√ß√£o simplificada dos c√°lculos
            // √çndices simulados (valores aproximados)
            const indice = 1.05; // CNJ
            const indiceselic = 1.08; // SELIC
            const indiceipca = 1.06; // IPCA
            const jurosmora = 1.03; // Juros de Mora

            // C√°lculos b√°sicos
            const indiceprinc = indice * indiceselic * indiceipca;
            const indicejur = indiceselic * indiceipca;

            const valorjurosmora = dados.valorPrincipal * indice * (jurosmora - 1);
            const juros = valorjurosmora + (dados.valorJuros * indice);

            const valorprincatt = dados.valorPrincipal * indiceprinc;
            const valorjurosatt = juros * indicejur;
            const valortotatt = valorprincatt + valorjurosatt;

            const percentualprinc = valorprincatt / valortotatt;
            const percentualjur = valorjurosatt / valortotatt;

            // Valor base conforme tipo de c√°lculo
            let valorBase = valortotatt;
            if (dados.tipoCalculo === 'preferencia' && dados.natureza === 'alimentar') {
                valorBase = Math.min(valortotatt, dados.tetoPreferencia);
            } else if (dados.tipoCalculo === 'acordo') {
                valorBase = valortotatt * (1 - dados.percentualAcordo);
            }

            const principal = valorBase * percentualprinc;
            const jurosBase = valorBase * percentualjur;

            // RRA
            const rrapagamento = dados.rra !== 0 ? (valorBase * dados.rra) / valortotatt : 0;

            // Honor√°rios
            let valorHonorarioTotal = 0;
            const honorarios = dados.advogados.map(adv => {
                const valorBruto = valorBase * adv.percentual;
                let ir = 0;
                if (adv.tipo === 'PF') {
                    ir = calcularIR(valorBruto);
                } else {
                    ir = valorBruto * 0.015;
                }
                const valorLiquido = valorBruto - ir;
                valorHonorarioTotal += valorBruto;
                
                return {
                    ...adv,
                    valorBruto,
                    ir,
                    valorLiquido
                };
            });

            // Previd√™ncia
            let valorPrevidencia = 0;
            let aliquotaEfetiva = 0;
            if (dados.incidenciaPrevidencia) {
                if (dados.tipoPrevidencia === 'fixa') {
                    valorPrevidencia = principal * dados.aliquotaFixa;
                    aliquotaEfetiva = dados.aliquotaFixa;
                } else {
                    // C√°lculo INSS simplificado
                    const base = rrapagamento === 0 ? principal : principal / rrapagamento;
                    const resultadoINSS = calcularINSS(base);
                    valorPrevidencia = resultadoINSS * (rrapagamento || 1);
                    aliquotaEfetiva = resultadoINSS / base;
                }
            }

            // IR sobre o benefici√°rio
            let valorIR = 0;
            let aliquotaIR = 0;
            if (dados.incidenciaIR && rrapagamento !== 0) {
                const percentualTotalAdv = dados.advogados.reduce((sum, adv) => sum + adv.percentual, 0);
                const baseIR = (principal - (principal * percentualTotalAdv) - valorPrevidencia) / rrapagamento;
                const valorIRUnitario = calcularIR(baseIR);
                valorIR = valorIRUnitario * rrapagamento;
                aliquotaIR = valorIRUnitario / baseIR;
            }

            return {
                valorprincatt,
                valorjurosatt,
                valortotatt,
                valorBase,
                principal,
                jurosBase,
                rrapagamento,
                honorarios,
                valorHonorarioTotal,
                valorPrevidencia,
                aliquotaEfetiva,
                valorIR,
                aliquotaIR,
                // √çndices para exibi√ß√£o
                indice,
                indiceselic,
                indiceipca,
                jurosmora
            };
        }

        function calcularIR(valorBruto) {
            if (valorBruto <= 2428.80) return 0;
            else if (valorBruto <= 2826.65) return (valorBruto * 0.075) - 182.16;
            else if (valorBruto <= 3751.05) return (valorBruto * 0.15) - 394.16;
            else if (valorBruto <= 4664.68) return (valorBruto * 0.225) - 675.49;
            else return (valorBruto * 0.275) - 908.73;
        }

        function calcularINSS(base) {
            if (base <= 1518.00) return base * 0.075;
            else if (base <= 2793.88) return 1518 * 0.075 + (base - 1518) * 0.09;
            else if (base <= 4190.83) return 1518 * 0.075 + 1275.88 * 0.09 + (base - 2793.88) * 0.12;
            else if (base <= 8157.41) return 1518 * 0.075 + 1275.88 * 0.09 + 1396.95 * 0.12 + (base - 4190.83) * 0.14;
            else return 951.63; // Teto
        }

        function exibirResultados(resultados, dados) {
            const container = document.getElementById('resultadosContent');
            
            const html = `
                <div class="table-container">
                    <h3>üìà Resumo dos C√°lculos</h3>
                    <table>
                        <tr>
                            <th>Descri√ß√£o</th>
                            <th>Valor</th>
                        </tr>
                        <tr>
                            <td>Valor Principal Atualizado</td>
                            <td>R$ ${resultados.valorprincatt.toFixed(2)}</td>
                        </tr>
                        <tr>
                            <td>Valor Juros Atualizado</td>
                            <td>R$ ${resultados.valorjurosatt.toFixed(2)}</td>
                        </tr>
                        <tr class="highlight">
                            <td>Total Atualizado</td>
                            <td>R$ ${resultados.valortotatt.toFixed(2)}</td>
                        </tr>
                        <tr class="highlight">
                            <td>Valor Base para C√°lculo</td>
                            <td>R$ ${resultados.valorBase.toFixed(2)}</td>
                        </tr>
                    </table>
                </div>

                <div class="table-container">
                    <h3>üí∞ Pagamento Benefici√°rio - ${dados.beneficiario}</h3>
                    <table>
                        <tr>
                            <th>Descri√ß√£o</th>
                            <th>Valor</th>
                        </tr>
                        <tr>
                            <td>Valor Devido</td>
                            <td>R$ ${(resultados.valorBase - resultados.valorHonorarioTotal).toFixed(2)}</td>
                        </tr>
                        <tr>
                            <td>Al√≠quota Efetiva Previd√™ncia</td>
                            <td>${(resultados.aliquotaEfetiva * 100).toFixed(2)}%</td>
                        </tr>
                        <tr>
                            <td>Previd√™ncia</td>
                            <td>R$ ${resultados.valorPrevidencia.toFixed(2)}</td>
                        </tr>
                        <tr>
                            <td>Al√≠quota IR</td>
                            <td>${(resultados.aliquotaIR * 100).toFixed(2)}%</td>
                        </tr>
                        <tr>
                            <td>Imposto de Renda</td>
                            <td>R$ ${resultados.valorIR.toFixed(2)}</td>
                        </tr>
                        <tr class="highlight">
                            <td>Valor L√≠quido</td>
                            <td>R$ ${(resultados.valorBase - resultados.valorHonorarioTotal - resultados.valorPrevidencia - resultados.valorIR).toFixed(2)}</td>
                        </tr>
                    </table>
                </div>

                ${resultados.honorarios.length > 0 ? `
                <div class="table-container">
                    <h3>üë©‚Äçüíº Pagamento Advogados</h3>
                    <table>
                        <tr>
                            <th>Nome</th>
                            <th>Tipo</th>
                            <th>Valor Devido</th>
                            <th>IR</th>
                            <th>Valor L√≠quido</th>
                        </tr>
                        ${resultados.honorarios.map(h => `
                        <tr>
                            <td>${h.nome}</td>
                            <td>${h.tipo}</td>
                            <td>R$ ${h.valorBruto.toFixed(2)}</td>
                            <td>R$ ${h.ir.toFixed(2)}</td>
                            <td>R$ ${h.valorLiquido.toFixed(2)}</td>
                        </tr>
                        `).join('')}
                    </table>
                </div>
                ` : ''}

                <div class="table-container">
                    <h3>üìä √çndices Utilizados</h3>
                    <table>
                        <tr>
                            <th>√çndice</th>
                            <th>Valor</th>
                            <th>Per√≠odo/Observa√ß√£o</th>
                        </tr>
                        <tr>
                            <td>√çndice CNJ</td>
                            <td>${resultados.indice.toFixed(6)}</td>
                            <td>${dados.mesBase}/${dados.anoBase}</td>
                        </tr>
                        <tr>
                            <td>SELIC Acumulada</td>
                            <td>${resultados.indiceselic.toFixed(6)}</td>
                            <td>Exceto per√≠odo de gra√ßa</td>
                        </tr>
                        <tr>
                            <td>IPCA-e Acumulado</td>
                            <td>${resultados.indiceipca.toFixed(6)}</td>
                            <td>Durante per√≠odo de gra√ßa</td>
                        </tr>
                        <tr>
                            <td>Juros de Mora</td>
                            <td>${resultados.jurosmora.toFixed(6)}</td>
                            <td>Natureza: ${dados.natureza}</td>
                        </tr>
                    </table>
                </div>
            `;

            container.innerHTML = html;
            document.getElementById('results').classList.remove('hidden');
            
            // Scroll para os resultados
            document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
        }
    </script>
</body>
</html>